<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>js18_cookie.html</title>
<script type="text/javascript">
	/*
		웹서비스 동작 방식: 클라이언트  --------------  서버
		                       request     response
		
		-cookie : 클라인언트 측에 저장되고, 용량이 적은 데이터, 정보를 유지/관리
		         서버로 전송됨, 용량은 4kb 제한, 도메인 하나당 쿠키 약 20개 정도
		
			-저장형식: 문자열 -> "key=value;id=hk;name=hankyung;....."
			                  ;으로 구분한다.
		    -저장내용: key, value, expires 기본 설정내용
		    	- expires: 설정단위 UTC기준(세계표준시)으로 Date객체를 이용해서 설정
		    	- domain: 쿠키사용범위 (주 도메인:  https://www.naver.com
		    			             서브 도메인: https://www.cafe.naver.com
		    			             주/서브도메인접근: .naver.com
		    						)      
		        - path : 쿠키사용범위(/admin/a/b, /admin/config)
		        - secure : https로만 접근할 수 있는지 여부 - true/false
		    
		    - 유효기간 설정: 쿠키의 사용기간 -> 설정X 브라우저가 종료될때 삭제됨
		                  설정방법 expires, max-age 두가지 방식 존재함
	*/
	
	function setCookieTest(){
		  setCookie("user5","hk5",1);  	
	}
	
	function getCookieTest(){
		getCookie("user1");
	}	    
		    
	function removeCookieTest(){
		removeCookie("user1");
		removeCookie("user2");
		removeCookie("user3");
	}
	
 	// setCookie()함수 구현
	function setCookie(name,value,expires,domain,path,secure){
		let cookies="";
		
		//인코딩 처리3가지
		//escape() : ASCII코드로 변환, 나머지 유니코드 변환 -> 이제 안씀
		//encodeURI() : 주소전체를 인코딩할때 사용
		//              일반 문자는 인코딩처리, 주소와 관련된 특수문자는 제외
		//              예) https://www.hankyung.com/user?id=hk&name=han
		//encodeURIComponent():모든 문자/특수문자 등등을 인코딩 처리함
		//                     파라미터에 대한 내용도 모두 처리 가능
		
		cookies+=name+"="+encodeURIComponent(value);//인코딩처리해서 저장
 		
		const date=new Date();
		date.setDate(date.getDate()+expires);//2025.08.29 + 5 -> 09.03까지
		cookies+=";expires="+date.toUTCString();//유효기간 설정(세계표준시)
	//  cookies+=";max_age="+(1000*1*60*60*24);// ms단위로 설정
		
		if(domain){
			cookies+=";domain="+domain;
		}
		if(path){
			cookies+=";path="+path;
		}
		if(secure){
			cookies+=";secure="+secure;
		}
	
		document.cookie=cookies;//쿠키 저장하기
	}
	
 	//getCookie 기능 구현
 	function getCookie(cookieName){
 		//cookie="user=hk;name=han;admin=kkk" -> 문자열 추출
 		//  ;    =  -> split(): 반환타입배열 , indexOf()
 		// split(";") -> [?] -> cookieName검색 -> "key=value" -> split("=")
 		
 		const cookieValue=document.cookie;// "k=v;k=v;.."
 		console.log(cookieValue);
 		const cookieSplit=cookieValue.split(";");
 		console.log(cookieSplit);
 		let value="";
//  		console.log(cookieSplit.indexOf(cookieName));
 		 	// ["user3=hk3","user1=hk1"]
 		for (var i = 0; i < cookieSplit.length; i++) {
			if(cookieSplit[i].indexOf(cookieName)!=-1){
				value=cookieSplit[i].split("=")[1];//["user3","hk3"]
				console.log("저장된 쿠키값:",value);
				return decodeURIComponent(value);
			}
		}
 		return null;
 	}
 	
 	//cookie 삭제 기능: expires 값을 재설정
 	function removeCookie(name){
 		const date=new Date();
 		date.setDate(date.getDate()-1);// 유효기간 지남
 		document.cookie=name+"=;expires="+date.toUTCString();
//  		document.cookie=name+"=;max-age=0";
 	}
 	
 /*
 	Web Storage : 데이터를 서버로 전송하지 않는다.
 				  저장공간이 쿠키보다 크다(최대 5MB)
 	
 	- sessionStorage : 웹페이지가 열려 있는 동안 값을 유지
 	                   
 	
 	- localStorage : 웹페이지가 종료되도 값을 유지
 	                 유효기간 없이 데이터를 저장한다.
 	                 삭제할때 캐시를 삭제하거나, javascirpt로 삭제한다.
 */
 	//메서드가 구현되어 있고 sessoi.., local.. 모두 이름이 동일하다.
 	sessionStorage.setItem("id1","value1");//추가
 	sessionStorage.getItem("id1");//가져오기
 	sessionStorage.removeItem("id1");
 	sessionStorage.clear();
 	
 	localStorage.setItem("id2","value2");추가
 	
</script>
</head>
<body>
<h1>쿠키사용하기</h1>
<button onclick="setCookieTest()">쿠키추가</button>
<button onclick="removeCookieTest()">쿠키삭제</button>
<button onclick="getCookieTest()">쿠키값 가져오기</button>
</body>
</html>



